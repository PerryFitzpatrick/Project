<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * * * The content below * * * * * * * * * * * -->
<!-- * * * * * * * * * * is only a placeholder * * * * * * * * * * -->
<!-- * * * * * * * * * * and can be replaced.  * * * * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * * * Delete the template below * * * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->

<style>
  :host {
    --bright-blue: oklch(51.01% 0.274 263.83);
    --electric-violet: oklch(53.18% 0.28 296.97);
    --french-violet: oklch(47.66% 0.246 305.88);
    --vivid-pink: oklch(69.02% 0.277 332.77);
    --hot-red: oklch(61.42% 0.238 15.34);
    --orange-red: oklch(63.32% 0.24 31.68);

    --gray-900: oklch(19.37% 0.006 300.98);
    --gray-700: oklch(36.98% 0.014 302.71);
    --gray-400: oklch(70.9% 0.015 304.04);

    --red-to-pink-to-purple-vertical-gradient: linear-gradient(
      180deg,
      var(--orange-red) 0%,
      var(--vivid-pink) 50%,
      var(--electric-violet) 100%
    );

    --red-to-pink-to-purple-horizontal-gradient: linear-gradient(
      90deg,
      var(--orange-red) 0%,
      var(--vivid-pink) 50%,
      var(--electric-violet) 100%
    );

    --pill-accent: var(--bright-blue);

    font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
      "Segoe UI Symbol";
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  h1 {
    font-size: 3.125rem;
    color: var(--gray-900);
    font-weight: 500;
    line-height: 100%;
    letter-spacing: -0.125rem;
    margin: 0;
    font-family: "Inter Tight", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
      "Segoe UI Symbol";
  }

  p {
    margin: 0;
    color: var(--gray-700);
  }

  main {
    width: 100%;
    min-height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    box-sizing: inherit;
    position: relative;
  }

  .angular-logo {
    max-width: 9.2rem;
  }

  .content {
    display: flex;
    justify-content: space-around;
    width: 100%;
    max-width: 700px;
    margin-bottom: 3rem;
  }

  .content h1 {
    margin-top: 1.75rem;
  }

  .content p {
    margin-top: 1.5rem;
  }

  .divider {
    width: 1px;
    background: var(--red-to-pink-to-purple-vertical-gradient);
    margin-inline: 0.5rem;
  }

  .pill-group {
    display: flex;
    flex-direction: column;
    align-items: start;
    flex-wrap: wrap;
    gap: 1.25rem;
  }

  .pill {
    display: flex;
    align-items: center;
    --pill-accent: var(--bright-blue);
    background: color-mix(in srgb, var(--pill-accent) 5%, transparent);
    color: var(--pill-accent);
    padding-inline: 0.75rem;
    padding-block: 0.375rem;
    border-radius: 2.75rem;
    border: 0;
    transition: background 0.3s ease;
    font-size: 0.875rem;
    font-style: normal;
    font-weight: 500;
    line-height: 1.4rem;
    letter-spacing: -0.00875rem;
    text-decoration: none;
  }

  .pill:hover {
    background: color-mix(in srgb, var(--pill-accent) 15%, transparent);
  }

  .pill-group .pill:nth-child(6n + 1) {
    --pill-accent: var(--bright-blue);
  }
  .pill-group .pill:nth-child(6n + 2) {
    --pill-accent: var(--french-violet);
  }
  .pill-group .pill:nth-child(6n + 3),
  .pill-group .pill:nth-child(6n + 4),
  .pill-group .pill:nth-child(6n + 5) {
    --pill-accent: var(--hot-red);
  }

  .pill-group svg {
    margin-inline-start: 0.25rem;
  }

  .social-links {
    display: flex;
    align-items: center;
    gap: 0.73rem;
    margin-top: 1.5rem;
  }

  .social-links path {
    transition: fill 0.3s ease;
    fill: var(--gray-400);
  }

  .social-links a:hover svg path {
    fill: var(--gray-900);
  }

  /* Auth button styles */
  .auth-button {
    position: absolute;
    top: 20px;
    right: 20px;
    padding: 10px 20px;
    border: 2px solid var(--bright-blue);
    background: transparent;
    color: var(--bright-blue);
    border-radius: 25px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.9rem;
  }

  .auth-button:hover {
    background: var(--bright-blue);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
  }

  .user-info {
    position: absolute;
    top: 20px;
    right: 20px;
    display: flex;
    align-items: center;
    gap: 12px;
    background: white;
    padding: 8px 16px;
    border-radius: 25px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .user-username {
    font-size: 0.9rem;
    color: var(--gray-700);
    font-weight: 500;
    cursor: pointer;
    transition: color 0.2s ease;
  }

  .user-username:hover {
    color: var(--bright-blue);
  }

  .logout-button {
    padding: 6px 12px;
    border: 1px solid #e5e7eb;
    background: #f9fafb;
    color: #6b7280;
    border-radius: 15px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .logout-button:hover {
    background: #f3f4f6;
    color: #374151;
  }

  .upload-button {
    margin-top: 2rem;
    padding: 12px 24px;
    background: var(--bright-blue);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1rem;
  }

  .upload-button:hover {
    background: #2563eb;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
  }

  .upload-status {
    margin-top: 1rem;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 500;
  }

  .upload-status.success {
    background: #d1fae5;
    color: #065f46;
  }

  .upload-status.error {
    background: #fee2e2;
    color: #991b1b;
  }

  .upload-status.loading {
    background: #dbeafe;
    color: #1e40af;
  }

  /* Email form styles */
  .email-section {
    margin-top: 3rem;
    text-align: center;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .email-section h2 {
    color: var(--gray-900);
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    font-weight: 600;
  }

  .email-form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    align-items: center;
  }

  .email-textarea {
    width: 100%;
    max-width: 500px;
    padding: 12px;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    font-family: inherit;
    font-size: 1rem;
    resize: vertical;
    transition: border-color 0.3s ease;
  }

  .email-textarea:focus {
    outline: none;
    border-color: var(--bright-blue);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  .send-email-button {
    padding: 12px 24px;
    background: var(--bright-blue);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1rem;
    min-width: 120px;
  }

  .send-email-button:hover:not(:disabled) {
    background: #2563eb;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
  }

  .send-email-button:disabled {
    background: #9ca3af;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .email-status {
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 500;
    margin-top: 0.5rem;
  }

  .email-status.success {
    background: #d1fae5;
    color: #065f46;
  }

  .email-status.error {
    background: #fee2e2;
    color: #991b1b;
  }

  .email-status.loading {
    background: #dbeafe;
    color: #1e40af;
  }

  @media screen and (max-width: 650px) {
    .content {
      flex-direction: column;
      width: max-content;
    }

    .divider {
      height: 1px;
      width: 100%;
      background: var(--red-to-pink-to-purple-horizontal-gradient);
      margin-block: 1.5rem;
    }

    .auth-button, .user-info {
      top: 10px;
      right: 10px;
    }
  }

  /* Bunny.net upload styles */
  .bunny-upload-button {
    margin-top: 1rem;
    padding: 12px 24px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1rem;
  }

  .bunny-upload-button:hover {
    background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
  }

  .bunny-upload-status {
    margin-top: 1rem;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 500;
  }

  .bunny-upload-status.success {
    background: #d1fae5;
    color: #065f46;
  }

  .bunny-upload-status.error {
    background: #fee2e2;
    color: #991b1b;
  }

  .bunny-upload-status.loading {
    background: #dbeafe;
    color: #1e40af;
  }

  /* Email Photos styles */
  .email-photos-form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    max-width: 400px;
    margin: 0 auto;
  }

  .email-photos-input {
    padding: 12px 16px;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }

  .email-photos-input:focus {
    outline: none;
    border-color: var(--bright-blue);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  .email-photos-textarea {
    padding: 12px 16px;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    font-size: 1rem;
    resize: vertical;
    transition: border-color 0.3s ease;
  }

  .email-photos-textarea:focus {
    outline: none;
    border-color: var(--bright-blue);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  .email-photos-button {
    padding: 12px 24px;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1rem;
  }

  .email-photos-button:hover:not(:disabled) {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
  }

  .email-photos-button:disabled {
    background: #9ca3af;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .photo-email-status {
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 500;
  }

  .photo-email-status.success {
    background: #d1fae5;
    color: #065f46;
  }

  .photo-email-status.error {
    background: #fee2e2;
    color: #991b1b;
  }

  .photo-email-status.loading {
    background: #dbeafe;
    color: #1e40af;
  }
</style>

<main class="main">
  <!-- Auth button or user info -->
  <div *ngIf="!isLoggedIn" class="auth-button" (click)="openLoginModal()">
    Login
  </div>
  
  <div *ngIf="isLoggedIn" class="user-info">
    <span class="user-username" (click)="openUserProfileModal()">{{ currentUser?.username || 'User' }}</span>
    <button class="logout-button" (click)="logout()">Logout</button>
  </div>

  <div class="content">
    <div class="left-side">
      <h1 class="perry" (click)="hey()">perry.click</h1>
      <!-- Add buttons to call the Go backend -->
      <button (click)="callBackend()">Test Backend</button>
      <button (click)="navigateToAbout()">Hello Backend → About</button>
      <div>{{ response }}</div>
    </div>
  </div>

  <!-- Email Contact Form -->
  <div class="email-section">
    <h2>Send me a message</h2>
    <div class="email-form">
      <textarea 
        [(ngModel)]="emailMessage" 
        placeholder="Type your message here..."
        class="email-textarea"
        rows="4"
      ></textarea>
      <button 
        (click)="sendEmail()" 
        class="send-email-button"
        [disabled]="!emailMessage.trim() || emailSending"
      >
        {{ emailSending ? 'Sending...' : 'Send Email' }}
      </button>
      <div *ngIf="emailStatus" class="email-status" [class]="emailStatusClass">
        {{ emailStatus }}
      </div>
    </div>
  </div>

  <!-- Upload button - only show when logged in -->
  <div *ngIf="isLoggedIn" style="text-align: center;">
    <input 
      type="file" 
      id="fileInput" 
      accept=".jpg,.jpeg,.png,.gif" 
      (change)="handleFileUpload($event)" 
      style="display: none;"
      #fileInput
    >
    <button class="upload-button" (click)="fileInput.click()">
      📷 Upload Photo (D1)
    </button>
    <div *ngIf="uploadStatus" class="upload-status">
      {{ uploadStatus }}
    </div>
    
    <!-- Bunny.net upload section -->
    <div style="margin-top: 2rem;">
      <input 
        type="file" 
        id="bunnyFileInput" 
        accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff,.tif,.webp,.heic,.heif,.cr2,.nef,.arw,.dng,.mp4,.mov,.avi,.mkv,.wmv,.flv,.webm,.m4v,.3gp,.mts,.m2ts,.ts" 
        (change)="handleBunnyFileUpload($event)" 
        style="display: none;"
        #bunnyFileInput
      >
      <button class="bunny-upload-button" (click)="bunnyFileInput.click()">
        🚀 Upload Large File (Bunny.net)
      </button>
      <div *ngIf="bunnyUploadStatus" class="bunny-upload-status" [class]="bunnyUploadStatusClass">
        {{ bunnyUploadStatus }}
      </div>
    </div>

    <!-- Email Photos Section - only show when logged in -->
    <div *ngIf="isLoggedIn" style="margin-top: 2rem; text-align: center;">
      <h3>📧 Email Your Photos</h3>
      <div class="email-photos-form">
        <input 
          type="email" 
          [(ngModel)]="photoRecipientEmail" 
          placeholder="Recipient email address"
          class="email-photos-input"
        >
        <textarea 
          [(ngModel)]="photoEmailMessage" 
          placeholder="Add a message to your photos..."
          class="email-photos-textarea"
          rows="3"
        ></textarea>
        <button 
          (click)="emailPhotos()" 
          class="email-photos-button"
          [disabled]="!photoRecipientEmail.trim() || !photoEmailMessage.trim() || emailingPhotos"
        >
          {{ emailingPhotos ? 'Sending...' : '📧 Email Photos' }}
        </button>
        <div *ngIf="photoEmailStatus" class="photo-email-status" [class]="photoEmailStatusClass">
          {{ photoEmailStatus }}
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Login Modal -->
<app-login-modal 
  [isOpen]="showLoginModal"
  (closeModal)="closeLoginModal()"
  (loginSuccess)="onLoginSuccess($event)"
></app-login-modal>

<!-- User Profile Modal -->
<app-user-profile-modal 
  [isOpen]="showUserProfileModal"
  [user]="currentUser"
  (closeModal)="closeUserProfileModal()"
  (userUpdated)="onUserUpdated($event)">
</app-user-profile-modal> 